// https://github.com/Gillardo/bootstrap-ui-datetime-picker
// Version: 1.0.10
// Released: 2015-03-13 
angular.module("ui.bootstrap.datetimepicker",["ui.bootstrap.dateparser","ui.bootstrap.position"]).directive("datetimePicker",["$compile","$parse","$document","$position","dateFilter","dateParser","datepickerPopupConfig",function(a,b,c,d,e,f,g){return{restrict:"A",require:"ngModel",scope:{isOpen:"=?",enableDate:"=?",enableTime:"=?",todayText:"@",nowText:"@",dateText:"@",timeText:"@",clearText:"@",closeText:"@",dateDisabled:"&"},link:function(h,i,j,k){function l(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})}function m(a){if(a){if(angular.isDate(a)&&!isNaN(a))return k.$setValidity("date",!0),a;if(angular.isString(a)){var b=f.parse(a,n)||new Date(a);if(h.enableTime&&!h.enableDate&&a.length==n.length){var c="EEE MMM dd yyyy "+n,d="Fri Mar 12 2015 "+a;b=f.parse(d,c)||new Date(d)}return isNaN(b)?void k.$setValidity("date",!1):(k.$setValidity("date",!0),b)}return void k.$setValidity("date",!1)}return k.$setValidity("date",!0),null}var n,o,p=angular.isDefined(j.closeOnDateSelection)?h.$parent.$eval(j.closeOnDateSelection):g.closeOnDateSelection,q=angular.isDefined(j.datepickerAppendToBody)?h.$parent.$eval(j.datepickerAppendToBody):g.appendToBody;h.showButtonBar=angular.isDefined(j.showButtonBar)?h.$parent.$eval(j.showButtonBar):g.showButtonBar,h.enableDate=!(0==h.enableDate),h.enableTime=!(0==h.enableTime),h.showPicker=h.enableDate?"date":"time",h.todayText=h.todayText||"Today",h.nowText=h.nowText||"Now",h.clearText=h.clearText||"Clear",h.closeText=h.closeText||"Close",h.dateText=h.dateText||"Date",h.timeText=h.timeText||"Time",h.getText=function(a){return h[a+"Text"]||g[a+"Text"]},j.$observe("datetimePicker",function(a){n=a||g.datepickerPopup,k.$render()});var r=angular.element('<div datetime-picker-popup><div ng-if="enableDate" collapse="!(showPicker == \'date\')" datepicker></div><div collapse="!(showPicker == \'time\')"><div timepicker style="margin:0 auto"></div></div></div>');r.attr({"ng-model":"date","ng-change":"dateSelection()"});var s=angular.element(r.children()[0]);j.datepickerOptions&&angular.forEach(h.$parent.$eval(j.datepickerOptions),function(a,b){s.attr(l(b),a)});var t=angular.element(r.children()[1].children[0]);j.timepickerOptions&&angular.forEach(h.$parent.$eval(j.timepickerOptions),function(a,b){t.attr(l(b),a)}),h.watchData={},angular.forEach(["minDate","maxDate","datepickerMode"],function(a){if(j[a]){var c=b(j[a]);if(h.$parent.$watch(c,function(b){h.watchData[a]=b}),s.attr(l(a),"watchData."+a),"datepickerMode"===a){var d=c.assign;h.$watch("watchData."+a,function(a,b){a!==b&&d(h.$parent,a)})}}}),j.dateDisabled&&s.attr("date-disabled","dateDisabled({ date: date, mode: mode })"),k.$parsers.unshift(m),h.dateSelection=function(a){h.enableDate&&h.enableTime&&"time"==h.showPicker&&o&&null!==o&&null!==h.date&&(o.setHours(h.date.getHours()),o.setMinutes(h.date.getMinutes()),o.setSeconds(h.date.getSeconds()),o.setMilliseconds(h.date.getMilliseconds()),h.date=o),o=h.date,angular.isDefined(a)&&(h.date=a),k.$setViewValue(h.date),k.$render(),p&&"time"!=h.showPicker&&(h.enableTime?h.showPicker="time":(h.isOpen=!1,i[0].focus()))},i.bind("input change keyup",function(){h.$apply(function(){h.date=k.$modelValue})}),k.$render=function(){var a=k.$viewValue?m(k.$viewValue):null,b=a?e(a,n):"";i.val(b),h.date=a};var u=function(a){h.isOpen&&a.target!==i[0]&&h.$apply(function(){h.isOpen=!1})},v=function(a){h.keydown(a)};i.bind("keydown",v),h.keydown=function(a){27===a.which?(a.preventDefault(),a.stopPropagation(),h.close()):40!==a.which||h.isOpen||(h.isOpen=!0)},h.$watch("isOpen",function(a){a?(h.$broadcast("datepicker.focus"),h.position=q?d.offset(i):d.position(i),h.position.top=h.position.top+i.prop("offsetHeight"),c.bind("click",u)):c.unbind("click",u)}),h.select=function(a){if("today"===a||"now"==a){var b=new Date;angular.isDate(k.$modelValue)?(a=new Date(k.$modelValue),a.setFullYear(b.getFullYear(),b.getMonth(),b.getDate()),a.setHours(b.getHours(),b.getMinutes(),b.getSeconds(),b.getMilliseconds())):a=b}h.dateSelection(a)},h.close=function(){h.isOpen=!1,i[0].focus()},h.changePicker=function(a){h.showPicker=a};var w=a(r)(h);r.remove(),q?c.find("body").append(w):i.after(w),h.$on("$destroy",function(){w.remove(),i.unbind("keydown",v),c.unbind("click",u)})}}}]).directive("datetimePickerPopup",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/datetime-picker.html",link:function(a,b){b.bind("click",function(a){a.preventDefault(),a.stopPropagation()})}}}),angular.module("ui.bootstrap.datetimepicker").run(["$templateCache",function(a){"use strict";a.put("template/datetime-picker.html",'<ul class="dropdown-menu dropdown-menu-right" ng-style="{display: (isOpen && \'block\') || \'none\', top: position.top+\'px\', right: position.right+\'px\'}" style=left:inherit ng-keydown=keydown($event)><li style="padding:0 5px 5px 5px" class=datetime-picker><div ng-transclude></div></li><li ng-if=showButtonBar style=padding:5px><span class="btn-group pull-left" style=margin-right:10px><button ng-if="showPicker == \'date\'" type=button class="btn btn-sm btn-info" ng-click="select(\'today\')">{{ getText(\'today\') }}</button> <button ng-if="showPicker == \'time\'" type=button class="btn btn-sm btn-info" ng-click="select(\'now\')">{{ getText(\'now\') }}</button> <button type=button class="btn btn-sm btn-danger" ng-click=select(null)>{{ getText(\'clear\') }}</button></span> <span class="btn-group pull-right"><button ng-if="showPicker == \'date\' && enableTime" type=button class="btn btn-sm btn-default" ng-click="changePicker(\'time\')">{{ getText(\'time\')}}</button> <button ng-if="showPicker == \'time\' && enableDate" type=button class="btn btn-sm btn-default" ng-click="changePicker(\'date\')">{{ getText(\'date\')}}</button> <button type=button class="btn btn-sm btn-success" ng-click=close()>{{ getText(\'close\') }}</button></span></li></ul>')}]);