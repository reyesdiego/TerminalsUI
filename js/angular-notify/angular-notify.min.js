angular.module("cgNotify",[]).factory("notify",["$timeout","$http","$compile","$templateCache","$rootScope",function(a,b,c,d,e){var f=10,g=15,h=1e4,i="view/angular-notify.html",j="center",k=document.body,l=0,m=[],n=[],o=function(o){var p=!1;"object"!=typeof o&&(o={message:o}),o.title=o.title?o.title:"",o.duration=o.duration?o.duration:h,o.templateUrl=o.templateUrl?o.templateUrl:i,o.container=o.container?o.container:k,o.classes=o.classes?o.classes:"",o.onClose=angular.isFunction(o.onClose)?o.onClose:void 0;var q=o.scope?o.scope.$new():e.$new();if(q.$position=o.position?o.position:j,q.$message=o.message,q.$title=o.title,q.$classes=o.classes,q.$messageTemplate=o.messageTemplate,l>0)for(var r=n.length+1-l,s=0;r>s;s++)n[s].$close();b.get(o.templateUrl,{cache:d}).success(function(b){var d=c(b)(q);if(d.bind("webkitTransitionEnd oTransitionEnd otransitionend transitionend msTransitionEnd",function(a){("opacity"===a.propertyName||0===a.currentTarget.style.opacity||a.originalEvent&&"opacity"===a.originalEvent.propertyName)&&(d.remove(),m.splice(m.indexOf(d),1),n.splice(n.indexOf(q),1),i())}),o.messageTemplate){for(var e,h=0;h<d.children().length;h++)if(angular.element(d.children()[h]).hasClass("cg-notify-message-template")){e=angular.element(d.children()[h]);break}if(!e)throw new Error("cgNotify could not find the .cg-notify-message-template element in "+o.templateUrl+".");e.append(c(o.messageTemplate)(q))}angular.element(o.container).append(d),m.push(d),"center"===q.$position&&a(function(){q.$centerMargin="-"+d[0].offsetWidth/2+"px"}),q.$close=function(){d.css("opacity",0).attr("data-closing","true"),i(),p||(p=!0,angular.isDefined(o.onClose)&&o.onClose(q.$message))};var i=function(){for(var a=0,b=f,c=m.length-1;c>=0;c--){var d=10,e=m[c],h=e[0].offsetHeight,i=b+h+d;e.attr("data-closing")?i-=20:b+=h+g,e.css("bottom",i+"px").css("margin-bottom","-"+(h+d)+"px").css("visibility","visible"),a++}};a(function(){i()}),o.duration>0&&a(function(){q.$close()},o.duration)}).error(function(a){throw new Error("Template specified for cgNotify ("+o.templateUrl+") could not be loaded. "+a)});var t={};return t.close=function(){q.$close&&q.$close()},Object.defineProperty(t,"message",{get:function(){return q.$message},set:function(a){q.$message=a}}),n.push(q),t};return o.config=function(a){f=angular.isUndefined(a.startBottom)?f:a.startBottom,g=angular.isUndefined(a.verticalSpacing)?g:a.verticalSpacing,h=angular.isUndefined(a.duration)?h:a.duration,i=a.templateUrl?a.templateUrl:i,j=angular.isUndefined(a.position)?j:a.position,k=a.container?a.container:k,l=a.maximumOpen?a.maximumOpen:l},o.closeAll=function(){for(var a=m.length-1;a>=0;a--){var b=m[a];b.css("opacity",0)}},o}]);