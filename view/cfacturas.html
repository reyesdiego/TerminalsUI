<div class="container agp" ng-controller="cfacturasCtrl">
	<br>
	<div class="row">
		<div class="col-lg-4">
			<div class="xpage-header">
				<h1 id="forms">Control de facturas</h1>
			</div>
		</div>

		<div class="col-lg-8 well">
			<div class="row">
				<div class="col-lg-6">
					<label for="fechaDesde">Desde</label>
					<p class="input-group">
						<input type="text" class="form-control" id="fechaDesde" datepicker-popup="{{format}}" ng-model="desde"  is-open="openFechaDesde" datepicker-options="dateOptions" show-button-bar="false" show-weeks="false" ng-required="true" />
							<span class="input-group-btn">
								<button class="btn btn-default" ng-click="open($event, 'desde')"><i class="glyphicon glyphicon-calendar"></i></button>
							</span>
					</p>
				</div>
				<div class="col-lg-6">
					<label for="fechaHasta">Hasta</label>
					<p class="input-group">
						<input type="text" class="form-control" id="fechaHasta" datepicker-popup="{{format}}" ng-model="hasta"  is-open="openFechaHasta" datepicker-options="dateOptions" show-button-bar="false" show-weeks="false" ng-required="true" />
							<span class="input-group-btn">
								<button class="btn btn-default" ng-click="open($event, 'hasta')"><i class="glyphicon glyphicon-calendar"></i></button>
							</span>
					</p>
				</div>
			</div>
			<div class="row">
				<div class="col-lg-6">
					<label for="selectComprobante" >Tipo de comprobante</label>
					<select class="form-control" id="selectComprobante" ng-model="tipoComprobante">
						<option ng-repeat="comprobante in comprobantesTipos" value="{{ comprobante._id }}" ng-selected="$first">{{ comprobante.description }}</option>
					</select>
				</div>
				<div class="col-lg-6">
					<br>
					<button class="btn btn-default" ui-sref="control"><span class="glyphicon glyphicon-arrow-left"></span> Volver</button>
					<button class="btn btn-primary" ng-click="cargar()"><span class="glyphicon glyphicon-asterisk"></span> Cargar</button>
				</div>
			</div>
		</div>
	</div>

	<div data-ng-hide="$state.includes('cfacturas.result')" class="row">

		<tabset ng-show="terminoCarga" justified="true">
			<tab heading="Tasa a las cargas">
				<br>
				<div class="col-lg-12 well">
					<div class="panel {{ tasaCargas.cartel }}">
						<div class="panel-heading">
							<h3 class="panel-title">{{ tasaCargas.titulo }}</h3>
						</div>
						<div class="panel-body">
							<p>{{ tasaCargas.mensaje }}</p>
						</div>
					</div>

					<table ng-show="tasaCargas.mostrarResultado" class="table table-striped table-bordered table-hover">
						<thead>
						<tr>
							<th>Comprobante</th>
							<th>Razon Social</th>
							<th>Fecha</th>
							<th>Importe Total</th>
							<th>Detalles</th>
						</tr>
						</thead>
						<tbody>
						<tr ng-repeat="factura in tasaCargas.resultado">
							<td>{{ factura.nroComprob }}</td>
							<td>{{ factura.razon }}</td>
							<td>{{ factura.fecha.emision | date: 'dd/MM/yyyy' }}</td>
							<td>{{ factura.codMoneda | formatCurrency }} {{ factura.importe.total | currency }}</td>
							<td><button ui-sref=".result" class="btn btn-primary" ng-click="mostrarDetalle(factura)"><span class="glyphicon glyphicon-zoom-in"></span> M&aacute;s detalles</button></td>
						</tr>
						</tbody>
					</table>
					<pagination boundary-links="true" total-items="totalItemsTasaCargas" ng-model="$parent.currentPageTasaCargas" max-size="5" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"></pagination>
				</div>
			</tab>

			<tab heading="Correlatividad" >
				<br>
				<div class="col-lg-12">
					<div class="panel {{ pantalla.cartelCorrelativo }}">
						<div class="panel-heading">
							<h3 class="panel-title">{{ pantalla.tituloCorrelativo }}</h3>
						</div>
						<div class="panel-body">
							<p>{{ pantalla.mensajeCorrelativo }}</p>
							<span ng-repeat="numero in pantalla.resultadoCorrelativo">{{ numero }}<span ng-show="!$last"> - </span></span>
						</div>
					</div>
				</div>
			</tab>

			<tab heading="Control de códigos" >
				<br>
				<div class="col-lg-12 well">
					<div class="panel {{ pantalla.cartelCodigos }}">
						<div class="panel-heading">
							<h3 class="panel-title">{{ pantalla.tituloCodigos }}</h3>
						</div>
						<div class="panel-body">
							<p>{{ pantalla.mensajeCodigos }}</p>
							<span ng-repeat="numero in pantalla.resultadoCodigos">{{ numero }}<span ng-show="!$last"> - </span></span>
						</div>
					</div>

					<table ng-show="pantalla.mostrarResultado" class="table table-striped table-bordered table-hover">
						<thead>
						<tr>
							<th>Comprobante</th>
							<th>Razon Social</th>
							<th>Fecha</th>
							<th>Códigos faltantes</th>
							<th>Detalles</th>
						</tr>
						</thead>
						<tbody>
						<tr ng-repeat="comprobante in pantalla.comprobantesRotos">
							<td>{{ comprobante._id.nroComprob }}</td>
							<td>{{ comprobante._id.razon }}</td>
							<td>{{ comprobante._id.fecha | date: 'dd/MM/yyyy' }}</td>
							<td>{{ comprobante._id.impTot }}</td>
							<td><button ui-sref=".result" class="btn btn-primary" type="button" ng-click="mostrarDetalle(comprobante)"><span class="glyphicon glyphicon-zoom-in"></span> M&aacute;s detalles</button></td>
						</tr>
						</tbody>
					</table>
					<pagination boundary-links="true" total-items="totalItemsCodigos" ng-model="$parent.currentPageCodigos" max-size="5" ng-change="pageChangedCodigos()" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"></pagination>
				</div>

			</tab>

			<tab heading="Control de tarifas" >
				<br>
				<div class="row col-lg-12">
					<div class="panel {{ pantalla.cartelTarifas }}">
						<div class="panel-heading">
							<h3 class="panel-title">{{ pantalla.tituloTarifas }}</h3>
						</div>
						<div class="panel-body">
							<p>{{ pantalla.mensajeTarifas }}</p>
							<span ng-repeat="numero in pantalla.resultadoCorrelativo">{{ numero }}<span ng-show="!$last"> - </span></span>
						</div>
					</div>
				</div>

				<div class="row row col-lg-12">
					<table ng-show="pantalla.mostrarResultadoTarifas" class="table table-striped table-bordered table-hover">
						<thead>
						<tr>
							<th>Comprobante</th>
							<th>Razon Social</th>
							<th>Fecha</th>
							<th>Tarifas erróneas</th>
							<th>Detalles</th>
						</tr>
						</thead>
						<tbody>
						<tr ng-repeat="comprobante in pantalla.comprobantesMalCobrados">
							<td>{{ comprobante.nroComprob }}</td>
							<td>{{ comprobante.razon }}</td>
							<td>{{ comprobante.fecha.emision | date: 'dd/MM/yyyy' }}</td>
							<td><span ng-repeat="numeroCod in comprobante.codigosFaltantes">{{ numeroCod }}<span ng-show="!$last"> - </span></span></td>
							<td><button ui-sref=".result" class="btn btn-primary" type="button" ng-click="mostrarDetalle(comprobante)">M&aacute;s detalles</button></td>
						</tr>
						</tbody>
					</table>
				</div>
			</tab>

		</tabset>

	</div>

	<div data-ng-show="$state.includes('cfacturas.result')">
		<div ui-view></div>
	</div>

	<br>
</div>