<div class="container" ng-controller="matchPricesCtrl">

	<div ng-hide="nuevoConcepto">

		<div class="row">
			<div class="col-lg-12">
				<h1 class="hidden-xs"><img src="images/asociar.png" height="64" width="64">Asociación de tarifario</h1>
				<h1 class="visible-xs">Asoc. de tarifario</h1>
				<h3>{{terminal.full_name}} <span ng-show="acceso=='agp'">({{nombre}})</span></h3>
			</div>
		</div>

		<div class="row hidden-print">
			<div class="col-lg-12">
				<div class="input-group">
					<input type="text" class="form-control" ng-model="search" placeholder="Buscar por código, descripción o tarifa" toupper>
					<span class="input-group-btn"><button class="btn btn-default" ng-click="search = ''"><span class="glyphicon glyphicon-remove-circle"></span></button></span>
				</div>
				<div class="checkbox">
					<label>
						<input type="checkbox" ng-model="conMatch">Sólo códigos asociados
					</label>
					<label>
						<input type="checkbox" ng-model="tasas" ng-change="prepararDatos()">Sólo tasa a las cargas
					</label>
				</div>
			</div>
		</div>
		<!--<div class="row" ng-show="acceso=='terminal'">
			<div class="col-lg-12">
				<div class="input-group">
					<input type="text" class="form-control" ng-model="search" placeholder="Buscar por código, descripción o tarifa" toupper>
					<span class="input-group-btn"><button class="btn btn-default" ng-click="search = ''"><span class="glyphicon glyphicon-remove-circle"></span></button></span>
				</div>
			</div>
		</div>-->
		<div class="row" ng-hide="flagGuardado">
			<div class="col-lg-6">
				<div class="alert alert-dismissable alert-success">
					<button type="button" class="close" ng-click="esconderAlerta()">×</button>
					<strong>Éxito</strong> - Se han guardado los códigos de la página anterior.
				</div>
			</div>
		</div>

		<div class="row">
			<div class="col-lg-12">
				<div class="bs-example table-responsive">
					<table class="table table-bordered table-hover">
						<thead>
						<tr>
							<th><a href="" ng-click="ordenarPor('code')">
								<span class="glyphicon glyphicon-sort-by-attributes" ng-show="predicate == 'code' && !reverse"></span>
								<span class="glyphicon glyphicon-sort-by-attributes-alt" ng-show="predicate == 'code' && reverse"></span>
								<span class="glyphicon glyphicon-bookmark"></span> Código
							</a></th>
							<th><a href="" ng-click="ordenarPor('description')">
								<span class="glyphicon glyphicon-sort-by-attributes" ng-show="predicate == 'description' && !reverse"></span>
								<span class="glyphicon glyphicon-sort-by-attributes-alt" ng-show="predicate == 'description' && reverse"></span>
								<span class="glyphicon glyphicon-credit-card"></span> Tarifa
							</a></th>
							<th><a href="" ng-click="ordenarPor('topPrices[0].price')">
								<span class="glyphicon glyphicon-sort-by-attributes" ng-show="predicate == 'topPrices[0].price' && !reverse"></span>
								<span class="glyphicon glyphicon-sort-by-attributes-alt" ng-show="predicate == 'topPrices[0].price' && reverse"></span>
								<span class="glyphicon glyphicon-credit-card"></span> Tope
							</a></th>
							<th><span class="glyphicon glyphicon-check"></span> Código asociado</th>
							<th class="hidden-print" ng-show="acceso=='terminal'"><span class="glyphicon glyphicon-plus-sign"></span> Agregar</th>
						</tr>
						</thead>
						<tbody>
						<tr style="height:60px" ng-repeat="price in filteredPrices = (listaSeleccionada | orderBy : predicate : reverse | startFrom:(currentPage-1)*itemsPerPage | limitTo:itemsPerPage | filter: search)" class="{{ price.claseFila }}">
							<td class="col-lg-1">
								<span>{{ price.code }}</span>
							</td>
							<td class="col-lg-5">
								<span>{{ price.description | maxLength : 124 }}</span><a href="" ng-show="(price.description.length > 124) && !price.editar" popover="{{ price.description }}" popover-trigger="mouseenter"> (...)</a>
							</td>
							<td class="col-lg-2 text-right">
								<span>{{ price.currency | formatCurrency }} {{ price.topPrices[0].price | currency }}</span>
							</td>

							<td class="col-lg-2" style="text-align: right">
								<span ng-repeat="codigo in price.matches[0].match track by $index" ng-show="acceso=='terminal'">
									<a title="Eliminar" href ng-click="borrar(price, codigo)">{{ codigo }}</a>
									<span ng-show="!$last">, </span>
								</span>
								<span ng-repeat="codigo in price.matches[0].match track by $index" ng-show="acceso=='agp'">
									<span>{{ codigo }}</span>
									<span ng-show="!$last">, </span>
								</span>
							</td>
							<td class="col-lg-2 hidden-print" style="text-align: right" ng-show="acceso=='terminal'">
								<div class="input-group">
									<input type="text" class="form-control" ng-model="price.new" ng-keyup="hitEnter($event, price)" toupper>
									<span class="input-group-btn">
										<button type="button" class="btn btn-primary" ng-click="agregarCodigo(price, $index)" ng-init="price.disabled = true" ng-disabled="price.disabled"><span class="glyphicon glyphicon-plus"></span></button>
									</span>
								</div>
							</td>
							<td ng-show="price.terminal != 'AGP' && puedeEditar">
								<button class="btn btn-primary" popover="Modificar tarifa" popover-trigger="mouseenter" ng-click="editarTarifa(price)"><span class="glyphicon glyphicon-edit"></span></button>
							</td>
						</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>

		<div-pagination total-items="totalItems" current-page="currentPage"></div-pagination>

		<div class="row hidden-print" ng-show="acceso=='terminal'">
			<div class="col-lg-12">
				<button class="btn btn-primary" ng-click="guardar()"><span class="glyphicon glyphicon-floppy-disk"></span> Guardar</button>
				<button class="btn" ng-click="abrirNuevoConcepto()"><span class="glyphicon glyphicon-asterisk"></span> Nuevo concepto</button>
			</div>
		</div>

	</div>

	<div ng-show="nuevoConcepto">

		<div class="row">
			<div class="col-lg-12">
				<div class="xpage-header">
					<h1 id="nuevo">Otras tarifas</h1>
				</div>
			</div>
		</div>

		<div class="row">
			<div class="col-lg-6">
				<div class="well">
					<form ng-submit="guardarNuevoConcepto()" class="bs-example form-horizontal" name="cargaNuevoConcepto">
						<fieldset>
							<legend>Tarifa</legend>
							<div class="form-group">
								<label for="inputCodigo" class="col-lg-2 control-label">Código</label>
								<div class="col-lg-10">
									<input type="text" class="form-control" ng-model="codigo" id="inputCodigo" placeholder="Ingresar código" ng-required="esRequerido" toupper>
								</div>
							</div>
							<div class="form-group">
								<label for="inputDescri" class="col-lg-2 control-label">Descripción</label>
								<div class="col-lg-10">
									<input type="text" class="form-control" ng-model="descripcion" id="inputDescri" placeholder="Ingresar descripcion" ng-required="esRequerido">
								</div>
							</div>
							<div class="form-group">
								<label for="inputUnidad" class="col-lg-2 control-label">Unidad</label>
								<div class="col-lg-10">
									<select class="form-control" id="inputUnidad" ng-model="unidad" ng-required="esRequerido">
										<option value="CONTAINER" ng-selected="true">Contenedor</option>
										<option value="TN">tn</option>
										<option value="BOX">cajón</option>
									</select>
								</div>
							</div>
							<div class="form-group">
								<label for="inputMoneda" class="col-lg-2 control-label">Moneda</label>
								<div class="col-lg-10">
									<select class="form-control" id="inputMoneda" ng-model="moneda" ng-required="esRequerido">
										<option value="DOL">U$S</option>
										<option value="PES" ng-selected="true">$ARG</option>
									</select>
								</div>
							</div>
							<div class="form-group">
								<label for="inputPrecio" class="col-lg-2 control-label">Precio</label>
								<div class="col-lg-10">
									<input type="text" class="form-control" ng-model="precio" id="inputPrecio" placeholder="Ingresar precio" ng-required="esRequerido">
								</div>
							</div>
							<div class="form-group">
								<div class="col-lg-10 col-lg-offset-2">
									<button class="btn btn-default" ng-click="salir()"><span class="glyphicon glyphicon-arrow-left"></span> Cancelar</button>
									<button type="submit" class="btn btn-primary" ng-hide="flagEditando"><span class="glyphicon glyphicon-save"></span> Agregar</button>
									<button type="submit" class="btn btn-primary" ng-show="flagEditando"><span class="glyphicon glyphicon-save"></span> Guardar</button>
								</div>
							</div>
						</fieldset>
					</form>
				</div>
			</div>
			<div class="col-lg-6" ng-show="preciosHistoricos.length > 0">
				<form ng-submit="guardarNuevoConcepto()" class="bs-example form-horizontal" name="cargaNuevoConcepto">
					<fieldset>
						<legend>Tarifas hitóricas</legend>
						<div class="bs-example table-responsive">
							<table class="table table-striped table-bordered table-hover">
								<thead>
								<tr>
									<th class="col-lg-8 text-center">
										<span class="glyphicon glyphicon-bookmark"></span> Fecha
									</th>
									<th class="col-lg-4 text-center">
										<span class="glyphicon glyphicon-credit-card"></span> Precio
									</th>
								</tr>
								</thead>
								<tbody>
								<tr ng-repeat="price in preciosHistoricos">
									<td class="col-lg-8 text-center">{{ price.from | date: 'dd/MM/yyyy' }}</td>
									<td class="col-lg-4 text-center">{{ price.price | currency }}</td>
								</tr>
								</tbody>
							</table>
						</div>
					</fieldset>
				</form>
			</div>
		</div>

	</div>
</div>
<br>